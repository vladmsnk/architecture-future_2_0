### Процесс использования портала 


**Аутентификация и авторизация**

- Используется корпоративный SSO. При переходе на портал, система перенаправляет
на корпоративный Identity Provider (Keycloak, Hydra)
- После успешной аутентификации портал получает JWT‑токен с ролями. 
На основании этих ролей включаются или скрываются разделы в интерфейсе (например, «Финансы», «Клиники»).

**Создание отчёта**

1. **Выбор витрины**
   – Фронтенд запрашивает у API‑шлюза список доступных Data Marts с их схемами и предопределёнными метриками.

2. **Конфигурация отчёта**
   – На основании метаданных витрины UI предлагает перетаскивать поля для группировки, фильтров и сортировки.
   – При выборе полей проверяются права пользователя по ролям.

3. **Превью**
   – показывается сгенерированный SQL или оценка объёма данных.

4. **Запуск запроса**
   – По клику "Сгенерировать" формируется JSON-описание отчёта и отправляется на API‑шлюз.
   – Шлюз ставит задачу в очередь (Kafka) и возвращает `task_id`.

5. **Мониторинг статуса**
   – Портал отслеживает задачу через polling

6. **Получение результата**
   – По готовности результат сохраняется в S3 и становится доступен по presigned URL

7. **Экспорт**
   – Кнопки «Экспорт» (CSV/Excel/PDF) сразу скачивают готовый файл.

8. **Аудит**
   – Все запуски логируются (пользователь, время, параметры).

